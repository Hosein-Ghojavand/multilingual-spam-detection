# Multilingual SMS Spam Detection Using Machine Learning

Welcome to the Multilingual SMS Spam Detection repository!  
This project aims to **detect spam SMS messages** in both **English** and **Farsi** languages using **classical machine learning algorithms** and **synthetic data augmentation** techniques.  
It highlights how synthetic data generated by **Large Language Models (LLMs)** can improve spam detection performance.

---

## üéØ Motivation
Mobile communication is increasingly vulnerable to spam and malicious messages, which can cause inconvenience or even serious risks to users.
While many spam detection systems exist for English, resources for other languages like Farsi are limited.
This project addresses this gap by building multilingual spam detectors, while exploring how synthetic data generated by LLMs can **boost model performance**, especially when labeled data is limited.

---

## üõ§Ô∏è Goals & Challenges
- Develop robust spam classifiers for both high-resource (English) and low-resource (Farsi) languages.
- Evaluate the impact of **synthetic data** on classification performance.
- Build a clean, extensible project that others can use or build upon.
- Handle language-specific preprocessing challenges (e.g., Farsi normalization, emoji handling).

---

## üöÄ Project Overview

This project builds reliable SMS spam detectors for both English and Farsi languages using classical machine learning techniques, enhanced with synthetic data generation.

### Key Features
- Multilingual spam detection (**English** and **Farsi**).
- Synthetic data generation using open-source Large Language Models (LLMs).
- Preprocessing pipelines tailored for each language (including Farsi normalization, emoji handling).
- Evaluation of **18** classical machine learning models.
- Visualization of model performance using bar plots and heatmaps.

### Approach
- Preprocess datasets using natural language processing (NLP) techniques.
- Train models on original, synthetic, and combined datasets.
- Generate synthetic datasets with LLMs like **DeepSeek-r1:1.5b**, **Gemini 2.0 Flash**, and **Gemini 2.0 Flash Lite**.
- Evaluate models with metrics like accuracy, precision, recall, and F1-score.
- Visualize performance through intuitive plots for easy comparison.

---

## üìÅ Project Structure
The project is organized as follows:

```
Data/
‚îú‚îÄ‚îÄ English/
‚îÇ   ‚îú‚îÄ‚îÄ 1. Main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ english_sms.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Characters.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Emojis.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Sentences.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of words.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Spam_vs_Ham_distribution.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Top 20 Most Frequent Words.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Word Cloud.png
‚îÇ   ‚îú‚îÄ‚îÄ 2. Synthetic/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ synthetic_english_sms.csv   (generated with DeepSeek-r1:1.5b)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ synthetic_english_sms/   (visualizations of DeepSeek-r1:1.5b synthetic data)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Characters.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Emojis.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Sentences.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of words.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Spam_vs_Ham_distribution.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Top 20 Most Frequent Words.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Word Cloud.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ synthetic_english_sms_gemini.csv   (generated with Gemini)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ synthetic_english_sms_gemini/   (visualizations of Gemini synthetic data)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Characters.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Emojis.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Sentences.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of words.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Spam_vs_Ham_distribution.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Top 20 Most Frequent Words.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Word Cloud.png
‚îÇ   ‚îú‚îÄ‚îÄ 3. Preprocessed/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preprocessed_english_sms.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preprocessed_synthetic_english_sms.csv   (from DeepSeek synthetic data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preprocessed_synthetic_english_sms_gemini.csv   (from Gemini synthetic data)
‚îÇ   ‚îú‚îÄ‚îÄ 4. Combined/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ combined_english_sms.csv   (real + DeepSeek synthetic)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ combined_english_sms_gemini.csv   (real + Gemini synthetic)
‚îÇ
‚îú‚îÄ‚îÄ Farsi/
‚îÇ   ‚îú‚îÄ‚îÄ 1. Main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ farsi_sms.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Characters.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Emojis.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Sentences.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of words.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Spam_vs_Ham_distribution.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Top 20 Most Frequent Words.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Word Cloud.png
‚îÇ   ‚îú‚îÄ‚îÄ 2. Synthetic/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ synthetic_farsi_sms.csv   (generated with Gemini)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Characters.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Emojis.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of Sentences.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Number of words.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ F_Spam_vs_Ham_distribution.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Top 20 Most Frequent Words.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Word Cloud.png
‚îÇ   ‚îú‚îÄ‚îÄ 3. Preprocessed/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preprocessed_farsi_sms.csv
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ preprocessed_synthetic_farsi_sms.csv   (from Gemini synthetic data)
‚îÇ   ‚îú‚îÄ‚îÄ 4. Combined/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ combined_farsi_sms.csv   (real + Gemini synthetic)


Notebooks/
‚îú‚îÄ‚îÄ English/
‚îÇ   ‚îú‚îÄ‚îÄ Model Training/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Results/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_combined_english_sms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_combined_english_sms_gemini/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_english_sms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_synthetic_english_sms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_synthetic_english_sms_gemini/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_combined_english_sms.ipynb   (trained on real + DeepSeek synthetic data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_combined_english_sms_gemini.ipynb   (trained on real + Gemini synthetic data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_english_sms.ipynb   (trained on real English SMS data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_synthetic_english_sms.ipynb   (trained on DeepSeek synthetic data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_synthetic_english_sms_gemini.ipynb   (trained on Gemini synthetic data)
‚îÇ   ‚îú‚îÄ‚îÄ Synthetic Data Generation/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate_synthetic_english_sms.ipynb   (DeepSeek-r1:1.5b)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate_synthetic_english_sms_gemini.ipynb   (Gemini)
‚îÇ
‚îú‚îÄ‚îÄ Farsi/
‚îÇ   ‚îú‚îÄ‚îÄ Model Training/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Results/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_combined_farsi_sms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_farsi_sms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_synthetic_farsi_sms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ barplot_model_performance.png
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ heatmap_model_performance_chart.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_combined_farsi_sms.ipynb   (trained on real + Gemini synthetic data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_farsi_sms.ipynb   (trained on real Farsi SMS data)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Train_synthetic_farsi_sms.ipynb   (trained on Gemini synthetic data)
‚îÇ   ‚îú‚îÄ‚îÄ Synthetic Data Generation/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate_synthetic_farsi_sms.ipynb   (Gemini)

```
## üìÅ Data Availability

> **Note:**  
> Due to licensing and publication restrictions, the real Farsi SMS dataset collected for this project is currently under review for official release through the university‚Äôs Big Data Research Center.  
> As a result, the `Data/` folder, including original datasets and visualizations, is not included in this repository.  
> Synthetic datasets generated during the project may be shared separately upon request.

- **English SMS Dataset:**  
  The English SMS data used in this project is based on the [SMS Spam Collection Dataset](https://archive.ics.uci.edu/dataset/228/sms+spam+collection),  
  available through the UCI Machine Learning Repository.  
  License: Open Data

  ---

## üìä Results

Model performance is visualized using:
- **Bar plots** comparing F1-scores across models.
- **Heatmaps** showing detailed performance metrics.


## üõ†Ô∏è How to Run

1. Clone this repository:
   ```bash
   git clone https://github.com/Hosein-Ghojavand/multilingual-spam-detection.git
   ```
2. Set up a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows, use: venv\Scripts\activate
   ```
3. Install the required libraries:
   ```bash
   pip install -r requirements.txt
   ```
4. Open and run the notebooks inside the `Notebooks/` directory.

---

## üì¶ Requirements

Main libraries used include:
- scikit-learn
- pandas
- numpy
- matplotlib
- seaborn
- nltk
- hazm (for Farsi text preprocessing)

(Full list available in requirements.txt and inside individual notebooks.)

---

## ‚ö° Future Work

- Extend to more languages.
- Experiment with deep learning models (e.g., LSTM, transformers).
- Improve synthetic data generation methods.

---
